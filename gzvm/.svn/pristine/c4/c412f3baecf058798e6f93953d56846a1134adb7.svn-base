<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>国际垂直马拉松</title>

<link type="text/css" rel="stylesheet" href="/gzvm/css/bootstrap.css">
<link type="text/css" rel="stylesheet" href="/gzvm/client/css/common.css">
<link type="text/css" rel="stylesheet" href="/gzvm/client/css/register.css">
<script type="text/javascript" src="/gzvm/js/jquery-1.11.3.js"></script>
<script type="text/javascript" src="/gzvm/js/bootstrap.js"></script>
</head>
<body>
<div class="bg">
	<div id="header">
		<div class="header_panel" >
			<div class="header_item">
				<div class="row">
					<div class="col-md-6 logo_panel">
						<img id="logoImg" src="/gzvm/client/images/chuima.png" class="img-responsive logo_img">
						<p class="header_fonts">| 欢迎注册</p>
					</div>
					<div class="col-md-6 logo_panel">
						
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<div class="container content space_top">
		<div class="row step_panel">
			<div class="col-md-4 ">
				<p class="step align_c w step_current">1.填写用户信息</p>
			</div>
			<div class="col-md-4 ">
				<p class="step align_c w">2.手机验证</p>
			</div>
			<div class="col-md-4 ">
				<p class="step align_c w">3.注册成功</p>
			</div>
		</div>
		<div class="infor w space_top space_bottom" id="basic">
			<p class="hint align_c w space_top">为了保证您能正常参赛，请保证您所有填写信息正确无误！</p>
			<div class="row space_bottom">
				<div class="col-md-1"></div>
				<div class="col-md-1 align_l"><span class="required">*</span> 用户名</div>
				<div class="col-md-4">
					<input class="item w" type="text" id="tvUserName"/>
				</div>
				<div class="col-md-1"></div>
				<div class="clo-md-4 align_l ps">PS:建议使用字母和数字</div>
			</div>
			
			<div class="row space_bottom">
				<div class="col-md-1"></div>
				<div class="col-md-1 align_l"><span class="required">*</span> 密码</div>
				<div class="col-md-4">
					<input class="item w" type="text" id="tvPassWord"/>
				</div>
				<div class="col-md-1"></div>
				<div class="clo-md-4 align_l ps">PS:建议使用字母和数字，区分大小写</div>
			</div>
			
			<div class="row space_bottom">
				<div class="col-md-1"></div>
				<div class="col-md-1 align_l"><span class="required">*</span> 确认 密码</div>
				<div class="col-md-4">
					<input class="item w" type="text" id="tvNewPassWord"/>
				</div>
				<div class="col-md-1"></div>
				<div class="clo-md-4 align_l ps">请重新输入密码</div>
			</div>
			<div class="row space_bottom">
				<div class="col-md-1"></div>
				<div class="col-md-1 align_l"><span class="required">*</span> 证件类型</div>
				<div class="col-md-4">
					<select class="item w" type="select" id="selIdType">
						<option>身份证</option>
						<option>护照</option>
						<option>港澳通行证</option>
					</select>
				</div>
				<div class="col-md-1 align_l"><span class="required">*</span> 证件号码</div>
				<div class="col-md-4">
					<input class="item w" type="text" id="tvId"/>
				</div>
				<div class="col-md-1"></div>
			</div>
			
			<div class="row space_bottom">
				<div class="col-md-1"></div>
				<div class="col-md-1 align_l"><span class="required">*</span> 真实姓名</div>
				<div class="col-md-4">
					<input class="item w" type="text" id="tvMyName"/>
				</div>
				<div class="col-md-1 align_l"><span class="required">*</span> 性别</div>
				<div class="col-md-4">
					<select class="item w" type="select" id="selSex">
						<option>男</option>
						<option>女</option>
					</select>
				</div>
				<div class="col-md-1"></div>
			</div>
			
			<div class="row space_bottom">
				<div class="col-md-1"></div>
				<div class="col-md-1 align_l"><span class="required">*</span> 出生日期</div>
				<div class="col-md-4">
					<select name="SYear" id="SYear" class="date date_left">
					　　 <option value="">年</option>
					</select>
					<select name="SMonth" id="SMonth" class="date">
					　　 <option value="">月</option>
					</select>
					<select name="SDay" id="SDay" class="date date_right">
					　　 <option value="">日</option>
					</select>
				</div>
				
				<div class="col-md-6"></div>
			</div>
			
			<div class="row space_bottom">
				<div class="col-md-1"></div>
				<div class="col-md-1 align_l">职业</div>
				<div class="col-md-4">
					<input class="item w" type="text" id="tvPro"/>
				</div>
				<div class="col-md-1 align_l">邮箱</div>
				<div class="col-md-4">
					<input class="item w" type="text"/>
				</div>
				<div class="col-md-1"></div>
			</div>
			<div class="row space_bottom">
				<div class="col-md-1"></div>
				<div class="col-md-1 align_l">地址</div>
				<div class="col-md-7">
					<textarea class="area w" id="tvareAddr"></textarea>
				</div>
				<div class="col-md-1"></div>
			</div>
			
			<div class="row space_top ">
				<div class="col-md-4"></div>
				<div class="col-md-4">
					<input class="item w bg_color btn" type="submit" value="确认提交" id="basicSure"/>
				</div>
				<div class="col-md-4"></div>
			</div>
			
		</div>
		<div class="infor w space_top space_bottom" id="phone">
			<p class="hint align_c w space_top phone_hint">手机号用于以后登录，建议使用常用手机号码！</p>
			
			<div class="row space_bottom space_top ">
				<div class="col-md-3"></div>
				<div class="col-md-1 align_l"><span class="required">*</span> 手机号码</div>
				<div class="col-md-4">
					<input class="item w" type="text" id="tvMobile"/>
				</div>
				<div class="col-md-1"></div>
				<div class="clo-md-3 align_l ps">PS:填写常用手机号码</div>
			</div>
			
			<div class="row space_bottom">
				<div class="col-md-3"></div>
				<div class="col-md-1 align_l"><span class="required">*</span> 验证码</div>
				<div class="col-md-4">
					<input class="item verify_text" type="text" id="tvVarCode"/>
					<input class="item verify_btn bg_color" type="submit" value="获取验证码" id="subVarCode"/>
				</div>
				<div class="col-md-1"></div>
			</div>
			<div class="row space_top ">
				<div class="col-md-4"></div>
				<div class="col-md-4">
					<input class="item w bg_color btn sub_btn" type="submit" value="确认提交"  id="phoneSure"/>
				</div>
				<div class="col-md-4"></div>
			</div>
			
		</div>
		<div class="infor w space_top space_bottom" id="success">
			<div class="row space_bottom hint_panel">
				<div class="col-md-3"></div>
				<div class="col-md-2 align_c">
					<span class="hint_img">
						<img src="/gzvm/client/images/hint_img.png">
					</span>
				</div>
				<div class="col-md-5">
					<p class="success_hint align_l w space_top">恭喜您注册成功，开启精彩垂马生涯！</p>
				</div>
				<div class="col-md-2"></div>
			</div>
			<div class="row space_top ">
				<div class="col-md-4"></div>
				<div class="col-md-4">
					<input class="item w bg_color btn sub_btn" type="submit" value="立即登录"  id="successSure"/>
				</div>
				<div class="col-md-4"></div>
			</div>
			
		</div>
	</div>
	<div id="footer">
		<div class="footer_panel" >
			<p class="footer_item">广州垂马体育发展有限公司</p>
		</div>
	</div>
</div>

</body>
    <script type="text/javascript">
    var nickname;
    var password;
    var newPassWord;
    var idType;
    var idCard;
    var userName;
    var sex;
    var profession;
    var addr;
    var mobile;
    var varCode;
    var authCode;
    	$(".infor").eq(1).hide();
    	$(".infor").eq(2).hide();
    	$("#basicSure").click(function(){
    		 nickname=document.getElementById("tvUserName").value
    		 password=document.getElementById("tvPassWord").value
    		 newPassWord=document.getElementById("tvNewPassWord").value
    		//0是身份证,1是护照，2是港澳通
    		 idType=document.getElementById("selIdType").selectedIndex;
    		 idCard=document.getElementById("tvId").value;
    		 userName=document.getElementById("tvMyName").value;
    		//0是男生,1是女生
    		 sex=document.getElementById("selSex").selectedIndex;
    		 profession=document.getElementById("tvPro").value;
    		 addr=document.getElementById("tvareAddr").value;
    		$("#basic").hide();
    		$("#phone").show();
    		$(".step_panel .col-md-4 p").eq(1).addClass("step_current");
    	})
    	$("#phoneSure").click(function(){
    		mobile= document.getElementById("tvMobile").value;
    		authCode=document.getElementById("tvVarCode").value;
    		var url = '/gzvm/user!loginSms.action';
    		var data = {
    			mobile : mobile,
    			authCode:authCode
    		};
    		$.ajax({
    					url : url,
    					data : data,
    					dataType : 'json',
    					type : 'post',
    					success : function(result) {
    						alert(result.resultMsg);
    						if(result.resultCode!=0){
    							var url = '/gzvm/user!saveUser.action';
    							var data = {
    					    			mobile : mobile,
    					    			nickname:nickname,
    					    			userName:userName,
    					    			password:password,
    					    			idType:idType,
    					    			idCard:idCard,
    					    			sex:sex,
    					    			profession:profession,
    					    			addr:addr,
    					    			mobile:mobile
    					    		};
    							$.ajax({
    					            url : url,
    				             	data : data,
    					            dataType : 'json',
    					            type : 'post',
    					            success : function(result) {
    						        alert(result.resultMsg);
    						if(result.resultCode!=0){
    							//这里明天整 $.ajax{}
    							$("#phone").hide();
        			    		$("#success").show();
        			    		$(".step_panel .col-md-4 p").eq(2).addClass("step_current");	
    						}
    					},
    					failure : function(result) {
    						alert(result.resultMsg);
    					}
    			        	});
    						}
    					},
    					failure : function(result) {
    						alert(result.resultMsg);
    					}
    				});
    	})
    	$("#successSure").click(function(){
    		window.location.href="/gzvm/client/pages/client_login.jsp"
    	})
    	$("#subVarCode").click(function(){
    		mobile= document.getElementById("tvMobile").value;
    		var url = '/gzvm/user!getSmsCode.action';
    		var data = {
    			mobile : mobile,
    		};
    		$.ajax({
    					url : url,
    					data : data,
    					dataType : 'json',
    					type : 'post',
    					success : function(result) {
    						alert(result.resultMsg);
    					},
    					failure : function(result) {
    						alert(result.resultMsg);
    					}
    				});
    	})
    	
        $(function(){
            var yearid = $('#SYear')    //年所在的控件
            var monthid = $('#SMonth')    //月所在的控件
            var dayid = $('#SDay')    //天所在的控件
            var myDate = new Date();
            var year = myDate.getFullYear();
            
            for(var i=(year-70);i<=(year);i++){
                yearid.append('<option value="'+i+'">'+i+'</option>')
            }
            
            yearid.change(function(){
                monthid.html('')
                for(var i=1;i<=12;i++){
                    monthid.append('<option value="'+i+'">'+i+'</option>')
                }
                
                monthid.change()
            })
            
            monthid.change(function(){
                var yearValue = yearid.val()
                var monthValue = parseInt(monthid.val())
                var dayvalue ;
                dayid.html('')
                
                
              if(monthValue==1||monthValue==3||monthValue==5||monthValue==7||monthValue==8||monthValue==10||monthValue==12)   {
                    dayvalue = 31
                }else if(monthValue==4||monthValue==6||monthValue==11||monthValue==9)    {
                    dayvalue = 30
                }else if(monthValue==2){
                    
                    if(yearValue%4==0 && (yearValue%4 !=0 || yearValue%400==0)){ //闰年
                        dayvalue = 29
                    }else{
                        dayvalue = 28    
                    }
                    
                }
                
                for(var i=1;i<=dayvalue;i++){
                    dayid.append('<option value="'+i+'">'+i+'</option>')
                }
                                
            })
        })
    </script>
</html>